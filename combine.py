from xml.dom.minidom import parseString
import xlsxwriter , csv
import sys , string
import re , operator
import glob , os

benign_dataset = list()
malicious_dataset = list()

def read_data(filename):
	with open(filename , "r") as f:
		reader = csv.reader(f)
		data = list(reader)
		return data


benign_dataset = read_data("New_Benign.txt")
malicious_dataset = read_data("New_Malicious.txt")

benign_permissions = benign_dataset[0]
malicious_permissions = malicious_dataset[0]
benign_permissions.pop()
malicious_permissions.pop()
benign_dataset.pop(0)
malicious_dataset.pop(0)
# print benign_dataset[0]

# print "-0-0-0-0-0-0-0------------------------------000000000000000000000000-0-0-0-0-0-0"
benign_dataset.pop(len(benign_dataset) - 1)
malicious_dataset.pop(len(malicious_dataset) - 1)
# x = len(benign_dataset) - 1
# print benign_dataset[x]
# print len(benign_dataset)


#complete_perms = union(benign_permissions,malicious_permissions)
complete_perms = list()
for i in range(len(benign_permissions)):
	complete_perms.append(benign_permissions[i])
for i in range(len(malicious_permissions)):
	complete_perms.append(malicious_permissions[i])
complete_perms.append("CLASS_LABEL")
#print complete_perms
print len(complete_perms)
# print complete_perms


##you fucked up here correct this as soon as possible
#still fucked up!!! No 1s are there in dataset

def createCombinedDataset(benign_set, malicious_set, complete_perms, benign_permissions, malicious_permissions):
	new_dataset = list()

	#for benign
	for i in range(len(benign_set)): #about 999 occurences
		f_v = list()
		for k in range(len(benign_permissions)): #adding the benign set of features
			f_v.append(benign_dataset[i][k])
		for k in range(len(malicious_permissions)): #adding the malicious set of features all of which are absent in benign apps
			f_v.append(-1)
		f_v.append(1)
		new_dataset.append(f_v)
	# print len(new_dataset)
	# print len(new_dataset[0])


	#for malicious
	for i in range(len(benign_set)): #about 1000 occurences
		f_v = list()
		for k in range(len(benign_permissions)): #adding the malicious set of features all of which are absent in benign apps
			f_v.append(-1)
		for k in range(len(malicious_permissions)): #adding the benign set of features
			f_v.append(malicious_dataset[i][k])
		new_dataset.append(f_v)
	
	# print len(new_dataset)
	# print len(new_dataset[0])


	return new_dataset

def refine_set(newdataset):
	with open("FinalCombinedset.txt","w") as file_in:
 		writer = csv.writer(file_in)
 		#print len(newdataset[0])
 		for data in newdataset:
 			for i in range(len(data)):
 				file_in.write(str(data[i]))
 				file_in.write(",")
 			"""file_in.writelines(data)"""
 			file_in.write("\n")

dataset = createCombinedDataset(benign_dataset, malicious_dataset, complete_perms, benign_permissions, malicious_permissions)
count = 0
#print dataset
for data in dataset:
	for i in range(len(data)):
		if data[i] == 1:
			count += 1
print count
#refine_set(dataset)